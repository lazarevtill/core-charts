# PostgreSQL configuration with automatic database and user creation
postgresql:
  # Override image to use latest stable version
  image:
    registry: docker.io
    repository: bitnami/postgresql
    tag: 15.4.0-debian-11-r45

  auth:
    # Password will be auto-generated if not set
    postgresPassword: ""
    database: "postgres"
    # Enable automatic password generation
    existingSecret: ""

  primary:
    persistence:
      enabled: false

    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

    # Init scripts mount from ConfigMap
    initdb:
      scriptsConfigMap: "{{ .Release.Name }}-postgresql-init"

  volumePermissions:
    enabled: false

  metrics:
    enabled: false
    serviceMonitor:
      enabled: false

# List of additional databases to create
# Passwords will be auto-generated if not provided
databases:
  - name: core_pipeline_dev
    user: core_user
    # Password will be generated automatically
  - name: core_pipeline_prod
    user: core_user_prod
    # Password will be generated automatically