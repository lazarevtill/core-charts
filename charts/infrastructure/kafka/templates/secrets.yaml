{{- range .Values.environments }}
---
apiVersion: v1
kind: Secret
metadata:
  name: kafka-{{ .name }}-secret
  namespace: {{ $.Release.Namespace }}
  labels:
    app: kafka
    environment: {{ .name }}
type: Opaque
data:
  KAFKA_BROKER: {{ printf "%s-kafka.%s.svc.cluster.local:9092" $.Release.Name $.Release.Namespace | b64enc }}
  KAFKA_CLIENT_ID: {{ .clientId | b64enc }}
  KAFKA_CONSUMER_GROUP: {{ .consumerGroup | b64enc }}
  # Legacy compatibility
  KAFKA_BROKERS: {{ printf "%s-kafka.%s.svc.cluster.local:9092" $.Release.Name $.Release.Namespace | b64enc }}
  KAFKA_GROUP_ID: {{ .consumerGroup | b64enc }}
{{- end }}