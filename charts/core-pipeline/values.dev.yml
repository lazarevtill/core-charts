# Development Environment Overrides

replicaCount: 1

image:
  pullPolicy: Always

# Database and Redis credentials from dev secrets
externalSecrets:
  # PostgreSQL credentials
  - envName: DB_HOST
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_HOST
  - envName: DB_PORT
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_PORT
  - envName: DB_USERNAME
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_USERNAME
  - envName: DB_PASSWORD
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_PASSWORD
  - envName: DB_DATABASE
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_DATABASE

  # Legacy PostgreSQL vars
  - envName: POSTGRES_HOST
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_HOST
  - envName: POSTGRES_PORT
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_PORT
  - envName: POSTGRES_USER
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_USERNAME
  - envName: POSTGRES_PASSWORD
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_PASSWORD
  - envName: POSTGRES_DB
    secretName: postgres-core-pipeline-dev-secret
    secretKey: DB_DATABASE

  # Redis credentials
  - envName: REDIS_HOST
    secretName: redis-dev-secret
    secretKey: REDIS_HOST
  - envName: REDIS_PORT
    secretName: redis-dev-secret
    secretKey: REDIS_PORT
  - envName: REDIS_PASSWORD
    secretName: redis-dev-secret
    secretKey: REDIS_PASSWORD
  - envName: BULL_REDIS_URL
    secretName: redis-dev-secret
    secretKey: REDIS_URL
  - envName: REDIS_URL
    secretName: redis-dev-secret
    secretKey: REDIS_URL

ingress:
  enabled: true
  hosts:
    - host: core-pipeline.dev.theedgestory.org
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: cloudflare-origin-tls
      hosts:
        - core-pipeline.dev.theedgestory.org
  altHost: core-pipeline-dev.theedgestory.org

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 200m
    memory: 256Mi

autoscaling:
  enabled: false

env:
  NODE_ENV: development
  LOG_LEVEL: debug
  LOG_PRETTY: "true"
  DB_LOGGING: "true"

  # Kafka
  KAFKA_CLIENT_ID: core-pipeline-dev
  KAFKA_BROKER: infrastructure-kafka.infrastructure.svc.cluster.local:9092
  KAFKA_CONSUMER_GROUP: core-pipeline-dev-group
  KAFKA_BROKERS: infrastructure-kafka.infrastructure.svc.cluster.local:9092
  KAFKA_GROUP_ID: core-pipeline-dev-group

  # Observability
  OTEL_SERVICE_NAME: core-pipeline-dev
